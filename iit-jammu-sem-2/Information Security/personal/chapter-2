symmetric cipher - a form of cryptosystem in which E & D are performed using
                    same key.

two types of attack on symmetric cipher - 
    a) brute force
    b) cryptanalysis

traditional symmetric cipher have used - 
    substitution and/or
    transposition 

substitution - maps plaintext elements(chars/bits) into ciphertext elements.
transposition - systematically transposes the positions of plaintext elements.

rotor machines - sophisticated precomputer hardware devices that use 
                 substitution techniques.

Steganography - a technique for hiding a secret message within a larger one
                in one in such a way that others cannot discern the presence
                or contents of the hidden message.

symmetric encryption - referred to as conventional encryption or 
                single-key encryption, was used before 1970s...

definition for - plaintext, ciphertext, enciphering/encryption, 
                deciphering/decryption


cryptanalysis - techniques used for deciphering the a message without 
                any knowledge of the enciphering details fall into the
                area of cryptanalysis.

cyptology = cryptography + cryptanalysis

5 ingredients of "Symmetric Cipher Model"

1. Plaintext
2. Encryption Algorithm
3. Secret Key
4. Ciphertext
5. Decryption Algorithm

There are 2 requirements for secure use of conventional encryption: 
1. We need a strong encryption algorithm.
    - Opponent should be unable to decrypt the ciphertext or discover the key
      even if he/she is in possession of a number of ciphertexts together
      with the plaintext that produced each ciphertext.
2. Sender and Receiver must have copies of secret key in a secure fashion,
    and must keep the key secure. If someone can discover the key and 
    knows the algorithm, all communication using this key is readable.

:: We do not need to keep the algorithm secret, we need to keep the key secret.::

- so, now manufacturing of these low-cost chip can be done without thinking
    of secrecy and can be developed and put into many devices at large scale.

Y = E(K, X)
X = D(K, Y)

Adversary wants to find an estimate X^  and for all the future messages - K^

Cryptographic systems characterized along three independent dimensions : 
1. "The type of operations used for transforming plaintext to ciphertext."
     - substitution or transposition
     - the fundamental requirement is that no information be lost
            i.e. all operations are reversible.
2. "The number of keys used."
     - symmentric, single-key, secret-key, or conventional encryption
     - asymmetric, two-key, or public-key encryption.
3. The way in which the plaintext is processed.
     - block cipher
     - stream cipher

Cryptanalysis and Brute-Force Attack
-------------------------------------
Cryptanalysis - rely on the nature of the algorithm plus perhaps
                some knowledge of the general characterstics of the plaintext
                or even some sample plaintext-ciphertext pairs.
                - exploits the characterstics of the algorithm to attempt
                
Brute force attack - every piece of keys tried. on average 1/2 of possible keys

ciphertext only attack- 


unconditionally secure - if the ciphertext generated by the scheme does not contain enough info
                        to determine uniquely the corresponding plaintext, 
                        no matter how much ciphertext is available.

        NOTE : EXCEPT One-Time Pad no encryption algorithm is unconditionally secure.

So, all that the users of an encryption algorithm can strive for is an algorithm - 
    - so the cost fo breaking the cipher exceeds the value of encrypted info.
    - the time required to break the cipher exceeds the useful lifetime of information.

---------------------------------------------------
conventions for below -
- plaintext always in lowercase
- ciphertext is in uppercase
- key in italicized lowercase

SUBSTITUTION TECHNIQUES :
1. CAESER CIPHER 
    C = E(3, p) = (p+3) mod 26
    C = E(k, p) = (p + k) mod 26
    p = D(k, C) = (C-k) mod 26

With only 25 keys, CAESER cipher is far from secure.

2. MONOALPHABETIC CIPHERS : - arbitrary substitution
            let's define a permutation of finite set of elements S in an ordered sequence of all th elements
            of S, with each element apprearing exactly once.

25! = 4 * 10^26

NOTE : Monoalphabetic - bcoz a single cipher alphabet(mapping from a plain alphabet to cipher alphabet) is used per message.


Frequency Analysis

Counter measure to Monoalphabetic cipher is - 
            to provide multiple substitutes, known as homophones, for a single letter.
        For example, letter e can be assigned a number of different cipher symbols.
        such as 16, 74, 35, 21 etc.

but, again using help fo digrams cryptanalysis is relatively straightforward.

3. PLAYFAIR CIPHER : - the best known multiple letter encryption cipher

        - treats digrams in the plaintext as single units and translates these units into 
            cipher digrams.

5 * 5 matrix of letters - constructed using a keyword.


M O N A R 
C H Y|B D
E F G IJ K
L P Q S T
U V W X Z

letters of the keyword(minus duplicates) from left to right and then top to bottom.

1. Repeating plaintext letters that are in the same pair are separated with a filler letter, 
    such as x, so that balloon would be treated as ba lx lo on.

2.[letter to right] 
    Two plaintext letters that fall in the same row of the matrix are each replaced by 
    the letter to the right, with the first element of the row circularly following the last.
        For ex - ar is encrypted as RM.
3. [letter beneath]

4. hs -> BP    ea -> IM or JM


4. Hill Cipher :
                       (k11 k12 k13)
(c1 c2 c3) = (p1 p2 p3)(k21 k22 k23) mod 26
                       (k31 k32 k33)

- 3*3 hill cipher hides not only single letter but also two letter
    frequency information

    - strong against cipher text only attack, 
        but weak when it comes to known plain text attack
            - one can find a key, when a plain text

5. Polyalphabetic Ciphers
    5.a) Vigenere Cipher : 
    ----------------------
            C = C0, C1, C2,... Cn-1
              = E(K, P)
              = E[(k0, k1,... km-1),(p0, p1,...pn-1)]
              = (p0+k0) mod 26, (pm+1 + k1) mod 26, ... (p2m-1 + km-1)mod 26

        Ci = (pi + ki_mod(m)) mod 26 
        pi = (Ci - ki_mod(m)) mod 26
    - there are multiple ciphertext letters for each plaintext letter, 
        
    - but considerable frequency information remains

NOTE: important is to determine Length of KeyWord?
        - If two identical sequences of plaintext letters occur at a distance
            that is an integer multiple of keyword length, they will 
            generate identical ciphertext sequences. 

So, By looking at the common factors in the displacements of the
various sequences, the analyst should be able to make a good guess
of the keyword length.

So, after knowing length of the plaintext, we can use the known 
    frequency characterstics of the plaintext language to attack each 
    of the monoalphabetic ciphers separately.

autokey system :: keyword is concatenated with the plaintext itself
            to provide a running key.

- vulnerability - plaintext share the same frequency distribution 
                    of letters.

    5b. VERNAM CIPHER: 
    ------------------
- The ultimate defense against such a cryptanalysis is to choose a 
    keyword that is as long as the plaintext and has no 
    statistical relationship to it.


    ci = pi XOR ki

pi = ith binary digit of plaintext
ki = ith binary digit of key
ci = ith binary digit of ciphertext

    5.c ONE TIME PAD
-------------------------
An army officer suggested - an improvement to VERNAM cipher,
i)  using a random key as long as message,
ii) then discard the key and use another key for new message.

Therefore, if you did an exhaustive search of all possible 
keys, you would end up with many legible plaintexts, with no way
of knowing which was the intended plaintext. 
- therefore, the code is unbreakable.

- only cryptosystem with perfect secrecy.

Transposition Techniques :

meetmeafterthetogaparty

1. Rail Fence Technique
m e m a t r h t g p r y
 e t e f e t e o a a t

4312567
attackp
ostpone
duntilt
woamxyz

ttna aptm tsuo aodw coix knly petz

- easy to break using frequency analysis.
- increase the toughness by more stages of permutation of ciphertexts.


:: ROTOR MACHINES ::
Above example suggest that - multiple stages of encryption can produce an algorithm
that is significantly more difficult to cryptanalyze. 
- true for both : substitution as well as transposition

Steganography

The advantage of steganography is that it can be employed by parties who
have something to lose should the fact of their secret communication (not necessar-
ily the content) be discovered.

